(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-898a4e6a"],{"99cc":function(e,t,o){},"9eb2":function(e,t,o){"use strict";o("99cc")},f61c:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container"},[o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form",{ref:"form",staticStyle:{"padding-top":"5vh"},attrs:{model:e.form,"label-width":"120px"}},[o("el-row",[o("el-col",{attrs:{span:11}},[o("el-form-item",{attrs:{label:"电影名称"}},[o("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"fetch-suggestions":e.movieSearchSuggest,placeholder:"请输入电影名",clearable:"",size:"small"},on:{select:e.handleSelect},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1),o("el-col",{attrs:{span:11}},[o("el-form-item",{attrs:{label:"电影类型"}},[o("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"fetch-suggestions":e.genreSearchSuggest,placeholder:"请输入电影类型",clearable:"",size:"small"},on:{select:e.handleSelect},model:{value:e.form.genre,callback:function(t){e.$set(e.form,"genre",t)},expression:"form.genre"}})],1)],1)],1),o("el-form-item",{attrs:{label:"上映时间"}},[o("div",[o("span",{staticStyle:{"font-weight":"300","margin-left":"5px","margin-right":"10px"}},[e._v("年份（1931-2022）")]),o("el-input-number",{staticStyle:{width:"146px"},attrs:{size:"mini",max:2022,min:1930,"controls-position":"right"},model:{value:e.form.year,callback:function(t){e.$set(e.form,"year",t)},expression:"form.year"}})],1),o("div",{staticStyle:{display:"flex","margin-top":"10px"}},[o("div",{staticStyle:{"margin-top":"10px"}},[o("span",{staticStyle:{"font-weight":"300","margin-left":"5px","margin-right":"20px"}},[e._v("月份或季度")]),o("el-select",{staticClass:"m-2",staticStyle:{width:"75px","margin-right":"15px"},attrs:{placeholder:"Select",size:"small"},model:{value:e.form.month_season,callback:function(t){e.$set(e.form,"month_season",t)},expression:"form.month_season"}},[o("el-option",{attrs:{label:"月份",value:"month"}}),o("el-option",{attrs:{label:"季度",value:"season"}}),o("el-option",{attrs:{label:"无",value:""}})],1),"month"==e.form.month_season?o("el-input-number",{staticStyle:{width:"100px"},attrs:{size:"mini",max:12,min:1,"controls-position":"right"},model:{value:e.form.month,callback:function(t){e.$set(e.form,"month",t)},expression:"form.month"}}):e._e(),"season"==e.form.month_season?o("el-input-number",{staticStyle:{width:"100px"},attrs:{size:"mini",min:1,max:4,"controls-position":"right"},model:{value:e.form.season,callback:function(t){e.$set(e.form,"season",t)},expression:"form.season"}}):e._e()],1),o("div",{staticStyle:{"margin-top":"10px"}},[o("span",{staticStyle:{"font-weight":"300","margin-left":"10px","margin-right":"20px"}},[e._v("天数或周几")]),o("el-select",{staticClass:"m-2",staticStyle:{width:"75px","margin-right":"15px"},attrs:{placeholder:"Select",size:"small"},model:{value:e.form.day_weekday,callback:function(t){e.$set(e.form,"day_weekday",t)},expression:"form.day_weekday"}},[o("el-option",{attrs:{label:"天数",value:"day"}}),o("el-option",{attrs:{label:"周几",value:"weekday"}}),o("el-option",{attrs:{label:"无",value:""}})],1),"day"==e.form.day_weekday?o("el-input-number",{staticStyle:{width:"100px"},attrs:{size:"mini",min:1,max:31,"controls-position":"right"},model:{value:e.form.day,callback:function(t){e.$set(e.form,"day",t)},expression:"form.day"}}):e._e(),"weekday"==e.form.day_weekday?o("el-input-number",{staticStyle:{width:"100px"},attrs:{size:"mini",min:1,max:7,"controls-position":"right"},model:{value:e.form.weekday,callback:function(t){e.$set(e.form,"weekday",t)},expression:"form.weekday"}}):e._e()],1)])]),o("el-row",[o("el-col",{attrs:{span:11}},[o("el-form-item",{attrs:{label:"导演"}},[o("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"fetch-suggestions":e.directorSearchSuggest,placeholder:"请输入导演名",clearable:"",size:"small"},on:{select:e.handleSelect},model:{value:e.form.director,callback:function(t){e.$set(e.form,"director",t)},expression:"form.director"}})],1)],1),o("el-col",{attrs:{span:11}},[o("el-form-item",{attrs:{label:"演员"}},[o("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"fetch-suggestions":e.actorSearchSuggest,placeholder:"请输入演员名",clearable:"",size:"small"},on:{select:e.handleSelect},model:{value:e.form.actor,callback:function(t){e.$set(e.form,"actor",t)},expression:"form.actor"}})],1)],1)],1),o("el-form-item",{attrs:{label:"评分"}},[o("el-input-number",{attrs:{size:"mini",precision:2,step:.01,max:e.form.max_score,min:0},model:{value:e.form.min_score,callback:function(t){e.$set(e.form,"min_score",t)},expression:"form.min_score"}}),o("span",{staticStyle:{"margin-left":"10px","margin-right":"10px"}},[e._v("至")]),o("el-input-number",{attrs:{size:"mini",precision:2,step:.01,max:5,min:e.form.min_score},model:{value:e.form.max_score,callback:function(t){e.$set(e.form,"max_score",t)},expression:"form.max_score"}})],1),o("el-form-item",{staticStyle:{"margin-left":"50px"},attrs:{label:"正面评价比例(大于等于)","label-width":"100px"}},[o("el-progress",{attrs:{type:"dashboard",size:"mini",percentage:e.form.positive,color:e.percentageColors}}),o("div",[o("el-button-group",[o("el-input-number",{attrs:{min:0,max:100,size:"mini"},model:{value:e.form.positive,callback:function(t){e.$set(e.form,"positive",t)},expression:"form.positive"}})],1)],1)],1),o("el-form-item",{attrs:{label:"查询字段"}},[o("el-checkbox-group",{model:{value:e.form.columns,callback:function(t){e.$set(e.form,"columns",t)},expression:"form.columns"}},[o("el-checkbox",{attrs:{label:"title"}},[e._v(" 标题 ")]),o("el-checkbox",{attrs:{label:"movieId"}},[e._v(" 编号 ")]),o("el-checkbox",{attrs:{label:"score"}},[e._v(" 评分 ")]),o("el-checkbox",{attrs:{label:"edition"}},[e._v(" 版本 ")]),o("el-checkbox",{attrs:{label:"format"}},[e._v(" 格式 ")]),o("el-checkbox",{attrs:{label:"date"}},[e._v(" 日期 ")]),o("el-checkbox",{attrs:{label:"directors"}},[e._v(" 导演 ")]),o("el-checkbox",{attrs:{label:"actors"}},[e._v(" 演员 ")]),o("el-checkbox",{attrs:{label:"runtime"}},[e._v(" 时长 ")]),o("el-checkbox",{attrs:{label:"genre"}},[e._v(" 类型 ")]),o("el-checkbox",{attrs:{label:"positive"}},[e._v(" 正面评价比例 ")])],1)],1)],1),o("div",{staticStyle:{"text-align":"center"}},[o("el-button",{staticStyle:{"margin-left":"3vh"},attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return e.search(e.form)}}},[e._v("查询")])],1)],1),o("el-col",{attrs:{span:1}},[o("el-divider",{attrs:{direction:"vertical"}})],1),o("el-col",{attrs:{span:10}},[o("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[o("el-tab-pane",{attrs:{label:"查询结果",name:"search_res"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticStyle:{width:"100%"},attrs:{data:e.result,"element-loading-text":"正在为您查询...",stripe:"",height:"450"}},[e.columns.title?o("el-table-column",{attrs:{prop:"movieTitle",label:"标题",width:"140"}}):e._e(),e.columns.movieId?o("el-table-column",{attrs:{prop:"movieId",label:"编号",width:"115"}}):e._e(),e.columns.date?o("el-table-column",{attrs:{prop:"date",label:"上映日期",width:"100"}}):e._e(),e.columns.score?o("el-table-column",{attrs:{prop:"movieScore",label:"评分",width:"80"}}):e._e(),e.columns.runtime?o("el-table-column",{attrs:{prop:"runtime",label:"时长",width:"80"}}):e._e(),e.columns.genre?o("el-table-column",{attrs:{prop:"genre",label:"类型",width:"120"}}):e._e(),e.columns.edition?o("el-table-column",{attrs:{prop:"edition",label:"版本",width:"80"}}):e._e(),e.columns.positive?o("el-table-column",{attrs:{prop:"positive",label:"正面评价比例",width:"80"}}):e._e(),e.columns.format?o("el-table-column",{attrs:{prop:"format",label:"格式",width:"140"}}):e._e(),e.columns.actors?o("el-table-column",{attrs:{prop:"actors",label:"演员",width:"200"}}):e._e(),e.columns.directors?o("el-table-column",{attrs:{prop:"directors",label:"导演",width:"200"}}):e._e()],1),o("el-row",{staticStyle:{"text-align":"center","margin-top":"20px"}},[o("el-pagination",{attrs:{layout:"prev, pager, next, jumper","current-page":e.currentPage,"page-size":10,"page-count":e.totalPage,small:""},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":function(t){return e.getNewPage(e.form)}}})],1)],1),o("el-tab-pane",{attrs:{label:"耗时对比",name:"speed"}},[o("div",{staticStyle:{width:"400px",height:"400px"},attrs:{id:"speed"}})])],1)],1)],1)],1)},s=[],l=o("9dc6"),n=(o("8180"),o("0197"),o("f1bd"),{name:"ComplexSearch",data:function(){return{activeName:"search_res",isLoading:!1,totalPage:0,currentPage:1,mysql_speed:0,spark_speed:0,form:Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])({title:"",min_score:0,max_score:5,year:null,month:null,season:null,day:null,weekday:null},"title",""),"genre",""),"director",""),"actor",""),"columns",[]),"month_season",""),"day_weekday",""),columns:{title:!1,asin:!1,score:!1,edition:!1,format:!1,data:!1,directors:!1,actors:!1},result:[],test:""}},mounted:function(){this.echartsInit()},watch:{mysql_speed:{handler:function(e,t){this.mysql_speed=e,this.echartsInit()}},spark_speed:{handler:function(e,t){this.spark_speed=e,this.echartsInit()}}},methods:{handleSelect:function(e){console.log(e)},handleClick:function(e,t){console.log(e,t)},movieSearchSuggest:function(e,t){var o=this;this.$axios.get("/recommend/movie",{params:{title:e,amount:10}}).then((function(e){console.log("这是结果",e.suggestions.length),console.log("这是第一条",e.suggestions[0]);for(var o=[],a=0;a<e.suggestions.length;a++)o.push({value:e.suggestions[a]});console.log("这是result",o),t(o)})).catch((function(e){o.$message.error("当前网络异常，请稍后再试")}))},genreSearchSuggest:function(e,t){var o=this;this.$axios.get("/recommend/genre",{params:{genre:e,amount:10}}).then((function(e){console.log(e);for(var o=[],a=0;a<e.suggestions.length;a++)o.push({value:e.suggestions[a]});console.log("这是result",o),t(o)})).catch((function(e){o.$message.error("当前网络异常，请稍后再试")}))},directorSearchSuggest:function(e,t){var o=this;this.$axios.get("/recommend/director",{params:{director:e,amount:10}}).then((function(e){console.log(e);for(var o=[],a=0;a<e.suggestions.length;a++)o.push({value:e.suggestions[a]});console.log("这是result",o),t(o)})).catch((function(e){o.$message.error("当前网络异常，请稍后再试")}))},actorSearchSuggest:function(e,t){var o=this;this.$axios.get("/recommend/actor",{params:{actor:e,amount:10}}).then((function(e){console.log(e);for(var o=[],a=0;a<e.suggestions.length;a++)o.push({value:e.suggestions[a]});console.log("这是result",o),t(o)})).catch((function(e){o.$message.error("当前网络异常，请稍后再试")}))},search:function(e){var t=this;if(0==e.columns.length)this.$message.warning("请至少输入一个条件!");else{for(var o in this.isLoading=!0,1930==e.year?(console.log("year为空"),e.year=null,console.log(e.year)):console.log(e.year),""==e.month_season?(console.log("月份季度为空"),e.month=null,e.season=null):"month"==e.month_season?(console.log("选择月份"),e.season=null):(e.month_season="season")&&(console.log("选择季度"),e.month=null),""==e.day_weekday?(console.log("天数为空"),e.day=null,e.weekday=null):"day"==e.day_weekday?(console.log("选择天数"),e.weekday=null):(e.day_weekday="weekday")&&(console.log("选择周几"),e.day=null),this.columns)this.columns[o]=!1;console.log("这是原始条件",e.columns);for(o=0;o<e.columns.length;o++)this.columns[e.columns[o]]=!0,console.log("这是条件",e.columns[o],this.columns[e.columns[o]]);this.$axios.post("/movie/count",{genre_name:e.genre,min_score:e.min_score,max_score:e.max_score,title:e.title,director:e.director,actor:e.actor,year:e.year,month:e.month,season:e.season,weekday:e.weekday,day:e.day,positive:e.positive/100,page:1,per_page:10}).then((function(e){console.log("pages:",e.pages),t.totalPage=e.pages})),this.$axios.post("/movie/detail",{genre_name:e.genre,min_score:e.min_score,max_score:e.max_score,columns:e.columns,title:e.title,director:e.director,actor:e.actor,year:e.year,month:e.month,season:e.season,weekday:e.weekday,day:e.day,positive:e.positive/100,page:1,per_page:10}).then((function(e){if(console.log("这是mysql的结果",e),console.log("data",e.data),t.isLoading=!1,t.result=e.data,console.log("test",t.result),1==t.columns["title"])for(var o=0;o<t.result.length;o++)console.log("标题",t.result[o].movieTitle),t.result[o].movieTitle=t.result[o].movieTitle.replace(/\"/g,""),console.log("标题后",t.result[o].movieTitle);t.isLoading=!1,t.mysql_speed=e.consuming_time,console.log("mysql速度",t.mysql_speed)})).catch((function(e){t.$message.error("当前mysql网络异常，请稍后再试")})),this.$axios.post("/hive/movie/detail",{genre_name:e.genre,min_score:e.min_score,max_score:e.max_score,columns:e.columns,title:e.title,director:e.director,actor:e.actor,year:e.year,month:e.month,season:e.season,weekday:e.weekday,day:e.day,page:1,per_page:10}).then((function(e){console.log("这是spark的结果",e),t.spark_speed=e.consuming_time})).catch((function(e){t.$message.error("当前spark网络异常，请稍后再试")}))}},getNewPage:function(e){var t=this;if(console.log("切换页面"),console.log("当前页数",this.currentPage),this.isLoading=!0,0==e.columns.length)this.$message.warning("请至少输入一个条件!");else{1930==e.year?(console.log("year为空"),e.year=null,console.log(e.year)):console.log(e.year),""==e.month_season?(console.log("月份季度为空"),e.month=null,e.season=null):"month"==e.month_season?(console.log("选择月份"),e.season=null):(e.month_season="season")&&(console.log("选择季度"),e.month=null),""==e.day_weekday?(console.log("天数为空"),e.day=null,e.weekday=null):"day"==e.day_weekday?(console.log("选择天数"),e.weekday=null):(e.day_weekday="weekday")&&(console.log("选择周几"),e.day=null),console.log("这是原始条件",e.columns);for(var o=0;o<e.columns.length;o++)this.columns[e.columns[o]]=!0,console.log("这是条件",e.columns[o],this.columns[e.columns[o]]);this.$axios.post("/movie/detail",{genre_name:e.genre,min_score:e.min_score,max_score:e.max_score,columns:e.columns,title:e.title,director:e.director,actor:e.actor,year:e.year,month:e.month,season:e.season,weekday:e.weekday,day:e.day,positive:e.positive/100,page:this.currentPage,per_page:10}).then((function(e){console.log("这是mysql的结果",e),console.log("data",e.data),t.result=e.data,console.log(t.result),t.isLoading=!1,t.mysql_speed=e.consuming_time})).catch((function(e){t.$message.error("当前mysql网络异常，请稍后再试")})),this.$axios.post("/hive/movie/detail",{genre_name:e.genre,min_score:e.min_score,max_score:e.max_score,columns:e.columns,title:e.title,director:e.director,actor:e.actor,year:e.year,month:e.month,season:e.season,weekday:e.weekday,day:e.day,page:this.currentPage,per_page:10}).then((function(e){console.log("这是spark的结果",e),t.spark_speed=e.consuming_time})).catch((function(e){t.$message.error("当前spark网络异常，请稍后再试")}))}},echartsInit:function(){console.log("开始初始化"),this.$echarts.init(document.getElementById("speed")).setOption({title:{text:"组合查询耗时对比(s)"},tooltip:{},xAxis:{data:["mysql","hive"]},yAxis:{},series:[{name:"查询耗时(s)",type:"bar",data:[this.mysql_speed,this.spark_speed]}]})}}}),r=n,i=(o("9eb2"),o("1805")),c=Object(i["a"])(r,a,s,!1,null,"4e0debbb",null);t["default"]=c.exports}}]);